<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Appointments Technical Challenge API - Swagger UI</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="https://unpkg.com/swagger-ui-dist@5.0.0/swagger-ui.css"
    />
    <style>
      html {
        box-sizing: border-box;
        overflow: -moz-scrollbars-vertical;
        overflow-y: scroll;
      }

      *,
      *:before,
      *:after {
        box-sizing: inherit;
      }

      body {
        margin: 0;
        background: #fafafa;
        font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
      }

      .swagger-ui .topbar {
        background: linear-gradient(135deg, #e31e24 0%, #c51a1f 100%);
        border-bottom: 2px solid #a01017;
      }

      .swagger-ui .topbar .download-url-wrapper {
        display: none;
      }

      #swagger-ui {
        max-width: 1460px;
        margin: 0 auto;
      }

      .topbar-wrapper {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 10px 20px;
      }

      .topbar-wrapper .link {
        color: white;
        text-decoration: none;
        font-size: 1.5em;
        font-weight: bold;
      }

      .custom-header {
        background: linear-gradient(135deg, #e31e24 0%, #c51a1f 100%);
        color: white;
        padding: 20px;
        text-align: center;
        margin-bottom: 20px;
      }

      .custom-header h1 {
        margin: 0;
        font-size: 2.5em;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
      }

      .custom-header p {
        margin: 10px 0 0 0;
        font-size: 1.2em;
        opacity: 0.9;
      }

      .status-banner {
        background: rgba(76, 175, 80, 0.1);
        border-left: 4px solid #4caf50;
        padding: 15px;
        margin: 20px;
        border-radius: 5px;
      }

      .status-banner h3 {
        margin-top: 0;
        color: #2e7d32;
      }

      .status-banner ul {
        margin: 10px 0;
        padding-left: 20px;
      }

      .status-banner li {
        color: #388e3c;
        margin: 5px 0;
      }
    </style>
  </head>

  <body>
    <div class="custom-header">
      <h1>üè• Appointments Technical Challenge API</h1>
      <p>Sistema de Agendamiento de Citas M√©dicas con Arquitectura Serverless</p>
    </div>

    <div class="status-banner">
      <h3>‚úÖ Estado del Sistema</h3>
      <ul>
        <li>
          <strong>API Base URL:</strong> https://m0ktt5jp3i.execute-api.us-east-1.amazonaws.com/dev
        </li>
        <li><strong>EventBridge:</strong> Implementado y Funcionando</li>
        <li><strong>Procesamiento PE/CL:</strong> Operativo</li>
        <li><strong>Clean Architecture:</strong> SOLID Principles</li>
      </ul>
    </div>

    <div id="swagger-ui"></div>

    <script src="https://unpkg.com/swagger-ui-dist@5.0.0/swagger-ui-bundle.js"></script>
    <script src="https://unpkg.com/swagger-ui-dist@5.0.0/swagger-ui-standalone-preset.js"></script>
    <script>
      window.onload = function () {
        // OpenAPI specification embedded directly in the HTML
        const spec = {
          openapi: '3.0.3',
          info: {
            title: 'Appointments Technical Challenge',
            description:
              '**Sistema de agendamiento de citas m√©dicas para asegurados de Appointments Technical Challenge - Desaf√≠o T√©cnico**\n\nEsta API demuestra una arquitectura serverless escalable para gestionar citas m√©dicas \nen m√∫ltiples pa√≠ses (Per√∫ y Chile) con procesamiento as√≠ncrono y Clean Architecture.\n\n## Flujo de Procesamiento\n\n1. **POST /appointments** - Crea cita (estado: pending)\n2. **SNS ‚Üí SQS** - Distribuye por pa√≠s (PE/CL)\n3. **Lambda PE/CL** - Procesa y guarda en RDS\n4. **EventBridge** - Env√≠a evento de completaci√≥n\n5. **Lambda Completion** - Actualiza estado a "completed"\n\n## Arquitectura T√©cnica\n- **DynamoDB**: Almacenamiento r√°pido y consultas en tiempo real\n- **RDS MySQL**: Datos enriquecidos espec√≠ficos por pa√≠s\n- **EventBridge**: Eventos de conformidad de agendamiento\n- **Clean Architecture**: Principios SOLID y separaci√≥n de capas\n- **Monorepo TypeScript**: Librer√≠as compartidas type-safe\n',
            version: '1.0.0',
            contact: {
              name: 'Appointments Technical Challenge Engineering Team',
              email: 'engineering@appointments-challenge.com',
            },
            license: {
              name: 'MIT',
              url: 'https://opensource.org/licenses/MIT',
            },
          },
          servers: [
            {
              url: 'https://m0ktt5jp3i.execute-api.us-east-1.amazonaws.com/dev',
              description: 'Development server',
            },
            {
              url: 'https://api.appointments-challenge.com/appointments/v1',
              description: 'Production server (example)',
            },
          ],
          tags: [
            {
              name: 'appointments',
              description: 'Gesti√≥n de citas m√©dicas',
            },
            {
              name: 'health',
              description: 'Health checks y monitoreo',
            },
            {
              name: 'setup',
              description: 'Configuraci√≥n y inicializaci√≥n',
            },
          ],
          paths: {
            '/appointments': {
              get: {
                tags: ['appointments'],
                summary: 'Obtener todas las citas (con filtros)',
                description:
                  '**üîç Endpoint para obtener todas las citas con capacidades de filtrado y paginaci√≥n avanzadas**\n\nEste endpoint permite a los administradores y operadores obtener una vista completa de todas las citas en el sistema, con m√∫ltiples opciones de filtrado y paginaci√≥n para manejar grandes vol√∫menes de datos.\n\n### Casos de Uso\n- **Dashboard administrativo**: Vista general del estado de las citas\n- **Reportes operacionales**: An√°lisis de citas por pa√≠s, estado, fechas\n- **Auditor√≠a**: Seguimiento de citas completadas vs pendientes\n- **Optimizaci√≥n de recursos**: Identificar patrones de agendamiento\n\n### Filtros Disponibles\n- **Por Pa√≠s**: PE (Per√∫) / CL (Chile)\n- **Por Estado**: pending, processing, completed, failed\n- **Por Fechas**: Rango de fechas de creaci√≥n\n- **Paginaci√≥n**: Limit/offset para grandes datasets\n\n### Performance\n- **√çndices optimizados** en DynamoDB\n- **Cacheing autom√°tico** para consultas frecuentes\n- **L√≠mite por defecto**: 20 resultados para evitar timeouts\n\n> ‚ö†Ô∏è **Nota de Seguridad**: Este endpoint requiere privilegios administrativos en producci√≥n\n',
                operationId: 'getAllAppointments',
                parameters: [
                  {
                    name: 'country',
                    in: 'query',
                    description: 'Filtrar por pa√≠s (PE/CL)',
                    required: false,
                    schema: {
                      type: 'string',
                      enum: ['PE', 'CL'],
                      example: 'PE',
                    },
                  },
                  {
                    name: 'status',
                    in: 'query',
                    description: 'Filtrar por estado de la cita',
                    required: false,
                    schema: {
                      type: 'string',
                      enum: ['pending', 'processing', 'completed', 'failed'],
                      example: 'completed',
                    },
                  },
                  {
                    name: 'limit',
                    in: 'query',
                    description: 'N√∫mero m√°ximo de resultados a devolver',
                    required: false,
                    schema: {
                      type: 'integer',
                      minimum: 1,
                      maximum: 100,
                      default: 20,
                      example: 20,
                    },
                  },
                  {
                    name: 'offset',
                    in: 'query',
                    description: 'N√∫mero de resultados a saltar (para paginaci√≥n)',
                    required: false,
                    schema: {
                      type: 'integer',
                      minimum: 0,
                      default: 0,
                      example: 0,
                    },
                  },
                  {
                    name: 'fromDate',
                    in: 'query',
                    description: 'Fecha de inicio (ISO 8601) para filtrar citas',
                    required: false,
                    schema: {
                      type: 'string',
                      format: 'date-time',
                      example: '2025-09-01T00:00:00.000Z',
                    },
                  },
                  {
                    name: 'toDate',
                    in: 'query',
                    description: 'Fecha de fin (ISO 8601) para filtrar citas',
                    required: false,
                    schema: {
                      type: 'string',
                      format: 'date-time',
                      example: '2025-09-30T23:59:59.999Z',
                    },
                  },
                ],
                responses: {
                  200: {
                    description: 'Lista de citas obtenida exitosamente',
                    content: {
                      'application/json': {
                        schema: {
                          $ref: '#/components/schemas/GetAllAppointmentsResponse',
                        },
                      },
                    },
                  },
                  400: {
                    description: 'Par√°metros de consulta inv√°lidos',
                    content: {
                      'application/json': {
                        schema: {
                          $ref: '#/components/schemas/ErrorResponse',
                        },
                      },
                    },
                  },
                  500: {
                    description: 'Error interno del servidor',
                    content: {
                      'application/json': {
                        schema: {
                          $ref: '#/components/schemas/ErrorResponse',
                        },
                      },
                    },
                  },
                },
              },
              post: {
                tags: ['appointments'],
                summary: 'Crear nueva cita m√©dica',
                description:
                  "**üöÄ Endpoint principal para crear citas m√©dicas en el sistema**\n\nEste endpoint inicia el flujo completo de agendamiento de citas m√©dicas:\n\n### Flujo de Procesamiento As√≠ncrono\n1. **Validaci√≥n inicial** - Verifica datos del asegurado y disponibilidad\n2. **Almacenamiento DynamoDB** - Crea registro con estado 'pending'\n3. **Publicaci√≥n SNS** - Distribuye mensaje por pa√≠s (PE/CL)\n4. **Procesamiento espec√≠fico** - Lambda dedicado por pa√≠s procesa la cita\n5. **Almacenamiento RDS** - Guarda datos enriquecidos en MySQL\n6. **EventBridge** - Emite evento de completaci√≥n\n7. **Actualizaci√≥n estado** - Cambia estado a 'completed'\n\n### Pa√≠ses Soportados\n- **PE (Per√∫)**: Integraci√≥n con sistema MINSA\n- **CL (Chile)**: Integraci√≥n con FONASA\n\n### Validaciones\n- **insuredId**: Exactamente 5 d√≠gitos\n- **scheduleId**: ID v√°lido de horario disponible\n- **countryISO**: Solo PE y CL soportados\n- **medicalProcedure**: Procedimiento m√©dico v√°lido\n\n> üìã **Tip**: El estado inicial ser√° 'pending'. El procesamiento as√≠ncrono lo actualizar√° autom√°ticamente.\n",
                operationId: 'createAppointment',
                requestBody: {
                  description: 'Datos de la nueva cita m√©dica',
                  required: true,
                  content: {
                    'application/json': {
                      schema: {
                        $ref: '#/components/schemas/CreateAppointmentRequest',
                      },
                      examples: {
                        peru_cardiology: {
                          summary: 'Cita Cardiolog√≠a - Per√∫',
                          description: 'Ejemplo de cita para consulta cardiol√≥gica en Per√∫',
                          value: {
                            insuredId: '12345',
                            scheduleId: 100,
                            countryISO: 'PE',
                            medicalProcedure: 'Consulta Cardiolog√≠a',
                          },
                        },
                        chile_dermatology: {
                          summary: 'Cita Dermatolog√≠a - Chile',
                          description: 'Ejemplo de cita para consulta dermatol√≥gica en Chile',
                          value: {
                            insuredId: '67890',
                            scheduleId: 200,
                            countryISO: 'CL',
                            medicalProcedure: 'Consulta Dermatolog√≠a',
                          },
                        },
                        peru_surgery: {
                          summary: 'Cirug√≠a - Per√∫',
                          description: 'Ejemplo de cita para cirug√≠a en Per√∫',
                          value: {
                            insuredId: '11111',
                            scheduleId: 150,
                            countryISO: 'PE',
                            medicalProcedure: 'Cirug√≠a Ves√≠cula Biliar',
                          },
                        },
                      },
                    },
                  },
                },
                responses: {
                  201: {
                    description: 'Cita creada exitosamente',
                    content: {
                      'application/json': {
                        schema: {
                          $ref: '#/components/schemas/CreateAppointmentResponse',
                        },
                      },
                    },
                  },
                  400: {
                    description: 'Datos de entrada inv√°lidos',
                    content: {
                      'application/json': {
                        schema: {
                          $ref: '#/components/schemas/ErrorResponse',
                        },
                        examples: {
                          invalid_insured_id: {
                            summary: 'ID de asegurado inv√°lido',
                            value: {
                              success: false,
                              error: 'Validation failed: insuredId must be exactly 5 digits',
                            },
                          },
                          invalid_country: {
                            summary: 'Pa√≠s no soportado',
                            value: {
                              success: false,
                              error: 'Validation failed: countryISO must be either PE or CL',
                            },
                          },
                        },
                      },
                    },
                  },
                  500: {
                    description: 'Error interno del servidor',
                    content: {
                      'application/json': {
                        schema: {
                          $ref: '#/components/schemas/ErrorResponse',
                        },
                      },
                    },
                  },
                },
              },
            },
            '/appointments/{insuredId}': {
              get: {
                tags: ['appointments'],
                summary: 'Obtener citas de un asegurado espec√≠fico',
                description:
                  '**üë§ Obtiene todas las citas m√©dicas asociadas a un asegurado espec√≠fico**\n\nEste endpoint permite consultar el historial completo de citas de un asegurado, incluyendo citas pasadas, presentes y futuras.\n\n### Informaci√≥n Incluida\n- **Datos b√°sicos**: ID, estado, fecha de creaci√≥n\n- **Detalles m√©dicos**: Procedimiento, pa√≠s de atenci√≥n\n- **Metadatos**: Timestamps de procesamiento, TTL\n- **Estado de procesamiento**: pending ‚Üí processing ‚Üí completed\n\n### Casos de Uso\n- **Portal del paciente**: Mostrar historial de citas\n- **Call center**: Consulta r√°pida de informaci√≥n\n- **Seguimiento m√©dico**: Verificar estado de agendamientos\n- **Auditor√≠a**: Rastrear citas por asegurado\n\n### Performance\n- **Consulta optimizada** con √≠ndice en DynamoDB\n- **Respuesta t√≠pica**: < 100ms\n- **Ordenamiento**: Por fecha de creaci√≥n (m√°s reciente primero)\n\n> üîç **Tip**: Si el asegurado no tiene citas, se retornar√° una lista vac√≠a con c√≥digo 200\n',
                operationId: 'getAppointmentsByInsured',
                parameters: [
                  {
                    name: 'insuredId',
                    in: 'path',
                    description: 'ID del asegurado (exactamente 5 d√≠gitos)',
                    required: true,
                    schema: {
                      type: 'string',
                      pattern: '^\\d{5}$',
                      example: '12345',
                    },
                  },
                ],
                responses: {
                  200: {
                    description: 'Citas del asegurado obtenidas exitosamente',
                    content: {
                      'application/json': {
                        schema: {
                          $ref: '#/components/schemas/GetAppointmentsResponse',
                        },
                      },
                    },
                  },
                  400: {
                    description: 'ID de asegurado inv√°lido',
                    content: {
                      'application/json': {
                        schema: {
                          $ref: '#/components/schemas/ErrorResponse',
                        },
                      },
                    },
                  },
                  500: {
                    description: 'Error interno del servidor',
                    content: {
                      'application/json': {
                        schema: {
                          $ref: '#/components/schemas/ErrorResponse',
                        },
                      },
                    },
                  },
                },
              },
            },
            '/health': {
              get: {
                tags: ['health'],
                summary: 'Health check del servicio',
                description:
                  '**üè• Endpoint de monitoreo para verificar el estado del servicio**\n\nEste endpoint proporciona informaci√≥n detallada sobre la salud y disponibilidad del sistema.\n\n### Informaci√≥n Incluida\n- **Estado general**: healthy/unhealthy\n- **Timestamp**: Momento exacto de la verificaci√≥n\n- **Metadatos del servicio**: Versi√≥n, ambiente, regi√≥n\n- **Identificador**: Nombre del servicio\n\n### Casos de Uso\n- **Load balancers**: Verificaci√≥n autom√°tica de salud\n- **Monitoreo**: CloudWatch, Datadog, etc.\n- **CI/CD**: Validaci√≥n post-deployment\n- **Debugging**: Verificaci√≥n r√°pida de conectividad\n\n### SLA\n- **Disponibilidad esperada**: 99.9%\n- **Tiempo de respuesta**: < 50ms\n- **Frecuencia recomendada**: Cada 30 segundos\n\n> ‚úÖ **Status 200**: Servicio operativo y saludable\n> ‚ùå **Status 5xx**: Servicio con problemas\n',
                operationId: 'healthCheck',
                responses: {
                  200: {
                    description: 'Servicio saludable y operativo',
                    content: {
                      'application/json': {
                        schema: {
                          $ref: '#/components/schemas/HealthResponse',
                        },
                      },
                    },
                  },
                  503: {
                    description: 'Servicio no disponible',
                    content: {
                      'application/json': {
                        schema: {
                          $ref: '#/components/schemas/ErrorResponse',
                        },
                      },
                    },
                  },
                },
              },
            },
            '/setup/database': {
              post: {
                tags: ['setup'],
                summary: 'üîß Configurar base de datos RDS',
                description:
                  "**‚öôÔ∏è Endpoint administrativo para inicializar las tablas de base de datos RDS**\n\n> ‚ö†Ô∏è **ADVERTENCIA**: Este es un endpoint administrativo que solo debe usarse durante la configuraci√≥n inicial del sistema.\n\n### Funcionalidad\n- **Crea tablas MySQL** en RDS para PE y CL\n- **Configuraci√≥n de √≠ndices** optimizados\n- **Validaci√≥n de conectividad** a la base de datos\n- **Esquema de datos** espec√≠fico por pa√≠s\n\n### Requisitos\n- **Privilegios de administrador**\n- **Conexi√≥n a RDS** configurada\n- **Variables de entorno** correctas\n\n### Tablas Creadas\n```sql\n-- Tabla para Per√∫ (PE)\nCREATE TABLE appointments_pe (\n  id VARCHAR(36) PRIMARY KEY,\n  insured_id VARCHAR(10) NOT NULL,\n  schedule_id INT NOT NULL,\n  medical_procedure TEXT,\n  status ENUM('pending','processing','completed','failed'),\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  INDEX idx_insured (insured_id),\n  INDEX idx_status (status)\n);\n\n-- Tabla similar para Chile (CL)\n```\n\n### Uso Recomendado\n1. **Solo una vez** durante el setup inicial\n2. **Ambiente de desarrollo** para testing\n3. **Disaster recovery** para recrear esquema\n\n> üö® **No ejecutar en producci√≥n** sin coordinaci√≥n con el equipo de DevOps\n",
                operationId: 'setupDatabase',
                responses: {
                  200: {
                    description: 'Base de datos configurada exitosamente',
                    content: {
                      'application/json': {
                        schema: {
                          type: 'object',
                          properties: {
                            success: {
                              type: 'boolean',
                              example: true,
                            },
                            message: {
                              type: 'string',
                              example: 'Database setup completed successfully',
                            },
                            data: {
                              type: 'object',
                              properties: {
                                tablesCreated: {
                                  type: 'array',
                                  items: {
                                    type: 'string',
                                  },
                                  example: ['appointments_pe', 'appointments_cl'],
                                },
                                timestamp: {
                                  type: 'string',
                                  format: 'date-time',
                                  example: '2025-09-12T21:35:55.978Z',
                                },
                              },
                            },
                          },
                        },
                      },
                    },
                  },
                  500: {
                    description: 'Error en la configuraci√≥n de la base de datos',
                    content: {
                      'application/json': {
                        schema: {
                          $ref: '#/components/schemas/ErrorResponse',
                        },
                      },
                    },
                  },
                },
                security: [
                  {
                    AdminAuth: [],
                  },
                ],
              },
            },
          },
          components: {
            schemas: {
              CreateAppointmentRequest: {
                type: 'object',
                required: ['insuredId', 'scheduleId', 'countryISO', 'medicalProcedure'],
                properties: {
                  insuredId: {
                    type: 'string',
                    pattern: '^\\d{5}$',
                    description: 'ID del asegurado (exactamente 5 d√≠gitos)',
                    example: '12345',
                  },
                  scheduleId: {
                    type: 'integer',
                    minimum: 1,
                    description: 'ID del horario de la cita',
                    example: 100,
                  },
                  countryISO: {
                    type: 'string',
                    enum: ['PE', 'CL'],
                    description: 'C√≥digo ISO del pa√≠s (PE para Per√∫, CL para Chile)',
                    example: 'PE',
                  },
                  medicalProcedure: {
                    type: 'string',
                    minLength: 3,
                    maxLength: 200,
                    description: 'Descripci√≥n del procedimiento m√©dico',
                    example: 'Consulta Cardiolog√≠a',
                  },
                },
              },
              CreateAppointmentResponse: {
                type: 'object',
                properties: {
                  success: {
                    type: 'boolean',
                    example: true,
                  },
                  data: {
                    type: 'object',
                    properties: {
                      appointmentId: {
                        type: 'string',
                        format: 'uuid',
                        description: 'ID √∫nico de la cita creada',
                        example: 'a1b2c3d4-e5f6-7890-abcd-ef1234567890',
                      },
                      status: {
                        type: 'string',
                        enum: ['pending'],
                        description: 'Estado inicial de la cita',
                        example: 'pending',
                      },
                      message: {
                        type: 'string',
                        description: 'Informaci√≥n sobre el procesamiento',
                        example: 'Appointment created and sent for processing',
                      },
                    },
                  },
                  message: {
                    type: 'string',
                    example: 'Appointment created successfully',
                  },
                },
              },
              Appointment: {
                type: 'object',
                properties: {
                  appointmentId: {
                    type: 'string',
                    format: 'uuid',
                    description: 'ID √∫nico de la cita',
                    example: 'a1b2c3d4-e5f6-7890-abcd-ef1234567890',
                  },
                  insuredId: {
                    type: 'string',
                    pattern: '^\\d{5}$',
                    description: 'ID del asegurado',
                    example: '12345',
                  },
                  scheduleId: {
                    type: 'integer',
                    description: 'ID del horario',
                    example: 100,
                  },
                  countryISO: {
                    type: 'string',
                    enum: ['PE', 'CL'],
                    description: 'Pa√≠s de la cita',
                    example: 'PE',
                  },
                  medicalProcedure: {
                    type: 'string',
                    description: 'Procedimiento m√©dico',
                    example: 'Consulta Cardiolog√≠a',
                  },
                  status: {
                    type: 'string',
                    enum: ['pending', 'processing', 'completed', 'failed'],
                    description: 'Estado actual de la cita',
                    example: 'completed',
                  },
                  createdAt: {
                    type: 'string',
                    format: 'date-time',
                    description: 'Fecha de creaci√≥n',
                    example: '2025-09-12T21:47:58.226Z',
                  },
                  updatedAt: {
                    type: 'string',
                    format: 'date-time',
                    description: 'Fecha de √∫ltima actualizaci√≥n',
                    example: '2025-09-12T21:48:01.583Z',
                  },
                  ttl: {
                    type: 'integer',
                    description: 'Time-to-live (timestamp Unix)',
                    example: 1760305678,
                  },
                },
              },
              GetAppointmentsResponse: {
                type: 'object',
                properties: {
                  success: {
                    type: 'boolean',
                    example: true,
                  },
                  data: {
                    type: 'object',
                    properties: {
                      appointments: {
                        type: 'array',
                        items: {
                          $ref: '#/components/schemas/Appointment',
                        },
                      },
                      total: {
                        type: 'integer',
                        description: 'N√∫mero total de citas',
                        example: 2,
                      },
                    },
                  },
                  message: {
                    type: 'string',
                    example: 'Appointments retrieved successfully',
                  },
                },
              },
              GetAllAppointmentsResponse: {
                type: 'object',
                properties: {
                  success: {
                    type: 'boolean',
                    example: true,
                  },
                  data: {
                    type: 'object',
                    properties: {
                      appointments: {
                        type: 'array',
                        items: {
                          $ref: '#/components/schemas/Appointment',
                        },
                        description: 'Lista de todas las citas (con filtros aplicados)',
                      },
                      total: {
                        type: 'integer',
                        description: 'N√∫mero total de citas que coinciden con los filtros',
                        example: 150,
                      },
                      limit: {
                        type: 'integer',
                        description: 'L√≠mite de resultados aplicado',
                        example: 20,
                      },
                      offset: {
                        type: 'integer',
                        description: 'Offset aplicado para paginaci√≥n',
                        example: 0,
                      },
                      hasMore: {
                        type: 'boolean',
                        description: 'Indica si hay m√°s resultados disponibles',
                        example: true,
                      },
                    },
                  },
                  message: {
                    type: 'string',
                    example: 'All appointments retrieved successfully',
                  },
                },
              },
              HealthResponse: {
                type: 'object',
                properties: {
                  success: {
                    type: 'boolean',
                    example: true,
                  },
                  data: {
                    type: 'object',
                    properties: {
                      status: {
                        type: 'string',
                        enum: ['healthy', 'unhealthy'],
                        example: 'healthy',
                      },
                      timestamp: {
                        type: 'string',
                        format: 'date-time',
                        example: '2025-09-12T21:35:55.978Z',
                      },
                      service: {
                        type: 'string',
                        example: 'rimac-appointment-api',
                      },
                      version: {
                        type: 'string',
                        example: '1.0.0',
                      },
                      environment: {
                        type: 'string',
                        example: 'dev',
                      },
                      region: {
                        type: 'string',
                        example: 'us-east-1',
                      },
                    },
                  },
                  message: {
                    type: 'string',
                    example: 'Service is healthy',
                  },
                },
              },
              ErrorResponse: {
                type: 'object',
                properties: {
                  success: {
                    type: 'boolean',
                    example: false,
                  },
                  error: {
                    type: 'string',
                    description: 'Descripci√≥n del error',
                    example: 'Validation failed: insuredId must be exactly 5 digits',
                  },
                },
              },
            },
            securitySchemes: {
              ApiKeyAuth: {
                type: 'apiKey',
                in: 'header',
                name: 'X-API-Key',
                description: 'API Key para autenticaci√≥n (futuro)',
              },
              AdminAuth: {
                type: 'apiKey',
                in: 'header',
                name: 'X-Admin-Token',
                description:
                  'üîí Token de administrador (RESTRINGIDO - No disponible en Swagger UI)',
              },
            },
          },
          externalDocs: {
            description: 'Documentaci√≥n t√©cnica completa',
            url: 'https://github.com/appointments-challenge/appointment-api/docs',
          },
        };

        // Initialize SwaggerUI
        const ui = SwaggerUIBundle({
          url: '',
          spec: spec,
          dom_id: '#swagger-ui',
          deepLinking: true,
          presets: [SwaggerUIBundle.presets.apis, SwaggerUIStandalonePreset],
          plugins: [SwaggerUIBundle.plugins.DownloadUrl],
          layout: 'StandaloneLayout',
          tryItOutEnabled: true,
          supportedSubmitMethods: ['get', 'post', 'put', 'delete', 'patch'],
          onComplete: function () {
            console.log('Swagger UI loaded successfully!');
          },
          onFailure: function (error) {
            console.error('Swagger UI failed to load:', error);
          },
        });

        window.ui = ui;

        // Auto health check
        setInterval(function () {
          fetch('https://m0ktt5jp3i.execute-api.us-east-1.amazonaws.com/dev/health')
            .then(response => response.json())
            .then(data => {
              console.log('‚úÖ API Health:', data.data.status);
            })
            .catch(error => {
              console.log('‚ùå API Health Check Failed:', error.message);
            });
        }, 60000); // Check every minute
      };
    </script>
  </body>
</html>
